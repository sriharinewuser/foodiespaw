{"ast":null,"code":"import _objectSpread from\"E:/foodiespaw/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext(null);const CART_KEY='cart';const EMPTY_CART={items:[],totalPrice:0,totalCount:0};export default function CartProvider(_ref){let{children}=_ref;const initCart=getCartFromLocalStorage();const[cartItems,setCartItems]=useState(initCart.items);const[totalPrice,setTotalPrice]=useState(initCart.totalPrice);const[totalCount,setTotalCount]=useState(initCart.totalCount);useEffect(()=>{const totalPrice=sum(cartItems.map(item=>item.price));const totalCount=sum(cartItems.map(item=>item.quantity));setTotalPrice(totalPrice);setTotalCount(totalCount);localStorage.setItem(CART_KEY,JSON.stringify({items:cartItems,totalPrice,totalCount}));},[cartItems]);function getCartFromLocalStorage(){const storedCart=localStorage.getItem(CART_KEY);return storedCart?JSON.parse(storedCart):EMPTY_CART;}const sum=items=>{return items.reduce((prevValue,curValue)=>prevValue+curValue,0);};const removeFromCart=foodId=>{const filteredCartItems=cartItems.filter(item=>item.food.id!==foodId);setCartItems(filteredCartItems);};const changeQuantity=(cartItem,newQauntity)=>{const{food}=cartItem;const changedCartItem=_objectSpread(_objectSpread({},cartItem),{},{quantity:newQauntity,price:food.price*newQauntity});setCartItems(cartItems.map(item=>item.food.id===food.id?changedCartItem:item));};const addToCart=food=>{const cartItem=cartItems.find(item=>item.food.id===food.id);if(cartItem){changeQuantity(cartItem,cartItem.quantity+1);}else{setCartItems([...cartItems,{food,quantity:1,price:food.price}]);}};const clearCart=()=>{localStorage.removeItem(CART_KEY);const{items,totalPrice,totalCount}=EMPTY_CART;setCartItems(items);setTotalPrice(totalPrice);setTotalCount(totalCount);};return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart:{items:cartItems,totalPrice,totalCount},removeFromCart,changeQuantity,addToCart,clearCart},children:children});}export const useCart=()=>useContext(CartContext);","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsx","_jsx","CartContext","CART_KEY","EMPTY_CART","items","totalPrice","totalCount","CartProvider","_ref","children","initCart","getCartFromLocalStorage","cartItems","setCartItems","setTotalPrice","setTotalCount","sum","map","item","price","quantity","localStorage","setItem","JSON","stringify","storedCart","getItem","parse","reduce","prevValue","curValue","removeFromCart","foodId","filteredCartItems","filter","food","id","changeQuantity","cartItem","newQauntity","changedCartItem","_objectSpread","addToCart","find","clearCart","removeItem","Provider","value","cart","useCart"],"sources":["E:/foodiespaw/frontend/src/hooks/useCart.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\r\n\r\nconst CartContext = createContext(null);\r\nconst CART_KEY = 'cart';\r\nconst EMPTY_CART = {\r\n  items: [],\r\n  totalPrice: 0,\r\n  totalCount: 0,\r\n};\r\n\r\nexport default function CartProvider({ children }) {\r\n  const initCart = getCartFromLocalStorage();\r\n  const [cartItems, setCartItems] = useState(initCart.items);\r\n  const [totalPrice, setTotalPrice] = useState(initCart.totalPrice);\r\n  const [totalCount, setTotalCount] = useState(initCart.totalCount);\r\n\r\n  useEffect(() => {\r\n    const totalPrice = sum(cartItems.map(item => item.price));\r\n    const totalCount = sum(cartItems.map(item => item.quantity));\r\n    setTotalPrice(totalPrice);\r\n    setTotalCount(totalCount);\r\n\r\n    localStorage.setItem(\r\n      CART_KEY,\r\n      JSON.stringify({\r\n        items: cartItems,\r\n        totalPrice,\r\n        totalCount,\r\n      })\r\n    );\r\n  }, [cartItems]);\r\n\r\n  function getCartFromLocalStorage() {\r\n    const storedCart = localStorage.getItem(CART_KEY);\r\n    return storedCart ? JSON.parse(storedCart) : EMPTY_CART;\r\n  }\r\n\r\n  const sum = items => {\r\n    return items.reduce((prevValue, curValue) => prevValue + curValue, 0);\r\n  };\r\n\r\n  const removeFromCart = foodId => {\r\n    const filteredCartItems = cartItems.filter(item => item.food.id !== foodId);\r\n    setCartItems(filteredCartItems);\r\n  };\r\n\r\n  const changeQuantity = (cartItem, newQauntity) => {\r\n    const { food } = cartItem;\r\n\r\n    const changedCartItem = {\r\n      ...cartItem,\r\n      quantity: newQauntity,\r\n      price: food.price * newQauntity,\r\n    };\r\n\r\n    setCartItems(\r\n      cartItems.map(item => (item.food.id === food.id ? changedCartItem : item))\r\n    );\r\n  };\r\n\r\n  const addToCart = food => {\r\n    const cartItem = cartItems.find(item => item.food.id === food.id);\r\n    if (cartItem) {\r\n      changeQuantity(cartItem, cartItem.quantity + 1);\r\n    } else {\r\n      setCartItems([...cartItems, { food, quantity: 1, price: food.price }]);\r\n    }\r\n  };\r\n\r\n  const clearCart = () => {\r\n    localStorage.removeItem(CART_KEY);\r\n    const { items, totalPrice, totalCount } = EMPTY_CART;\r\n    setCartItems(items);\r\n    setTotalPrice(totalPrice);\r\n    setTotalCount(totalCount);\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart: { items: cartItems, totalPrice, totalCount },\r\n        removeFromCart,\r\n        changeQuantity,\r\n        addToCart,\r\n        clearCart,\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n"],"mappings":"2GAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE9E,KAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,IAAI,CAAC,CACvC,KAAM,CAAAO,QAAQ,CAAG,MAAM,CACvB,KAAM,CAAAC,UAAU,CAAG,CACjBC,KAAK,CAAE,EAAE,CACTC,UAAU,CAAE,CAAC,CACbC,UAAU,CAAE,CACd,CAAC,CAED,cAAe,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC/C,KAAM,CAAAE,QAAQ,CAAGC,uBAAuB,CAAC,CAAC,CAC1C,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGf,QAAQ,CAACY,QAAQ,CAACN,KAAK,CAAC,CAC1D,KAAM,CAACC,UAAU,CAAES,aAAa,CAAC,CAAGhB,QAAQ,CAACY,QAAQ,CAACL,UAAU,CAAC,CACjE,KAAM,CAACC,UAAU,CAAES,aAAa,CAAC,CAAGjB,QAAQ,CAACY,QAAQ,CAACJ,UAAU,CAAC,CAEjET,SAAS,CAAC,IAAM,CACd,KAAM,CAAAQ,UAAU,CAAGW,GAAG,CAACJ,SAAS,CAACK,GAAG,CAACC,IAAI,EAAIA,IAAI,CAACC,KAAK,CAAC,CAAC,CACzD,KAAM,CAAAb,UAAU,CAAGU,GAAG,CAACJ,SAAS,CAACK,GAAG,CAACC,IAAI,EAAIA,IAAI,CAACE,QAAQ,CAAC,CAAC,CAC5DN,aAAa,CAACT,UAAU,CAAC,CACzBU,aAAa,CAACT,UAAU,CAAC,CAEzBe,YAAY,CAACC,OAAO,CAClBpB,QAAQ,CACRqB,IAAI,CAACC,SAAS,CAAC,CACbpB,KAAK,CAAEQ,SAAS,CAChBP,UAAU,CACVC,UACF,CAAC,CACH,CAAC,CACH,CAAC,CAAE,CAACM,SAAS,CAAC,CAAC,CAEf,QAAS,CAAAD,uBAAuBA,CAAA,CAAG,CACjC,KAAM,CAAAc,UAAU,CAAGJ,YAAY,CAACK,OAAO,CAACxB,QAAQ,CAAC,CACjD,MAAO,CAAAuB,UAAU,CAAGF,IAAI,CAACI,KAAK,CAACF,UAAU,CAAC,CAAGtB,UAAU,CACzD,CAEA,KAAM,CAAAa,GAAG,CAAGZ,KAAK,EAAI,CACnB,MAAO,CAAAA,KAAK,CAACwB,MAAM,CAAC,CAACC,SAAS,CAAEC,QAAQ,GAAKD,SAAS,CAAGC,QAAQ,CAAE,CAAC,CAAC,CACvE,CAAC,CAED,KAAM,CAAAC,cAAc,CAAGC,MAAM,EAAI,CAC/B,KAAM,CAAAC,iBAAiB,CAAGrB,SAAS,CAACsB,MAAM,CAAChB,IAAI,EAAIA,IAAI,CAACiB,IAAI,CAACC,EAAE,GAAKJ,MAAM,CAAC,CAC3EnB,YAAY,CAACoB,iBAAiB,CAAC,CACjC,CAAC,CAED,KAAM,CAAAI,cAAc,CAAGA,CAACC,QAAQ,CAAEC,WAAW,GAAK,CAChD,KAAM,CAAEJ,IAAK,CAAC,CAAGG,QAAQ,CAEzB,KAAM,CAAAE,eAAe,CAAAC,aAAA,CAAAA,aAAA,IAChBH,QAAQ,MACXlB,QAAQ,CAAEmB,WAAW,CACrBpB,KAAK,CAAEgB,IAAI,CAAChB,KAAK,CAAGoB,WAAW,EAChC,CAED1B,YAAY,CACVD,SAAS,CAACK,GAAG,CAACC,IAAI,EAAKA,IAAI,CAACiB,IAAI,CAACC,EAAE,GAAKD,IAAI,CAACC,EAAE,CAAGI,eAAe,CAAGtB,IAAK,CAC3E,CAAC,CACH,CAAC,CAED,KAAM,CAAAwB,SAAS,CAAGP,IAAI,EAAI,CACxB,KAAM,CAAAG,QAAQ,CAAG1B,SAAS,CAAC+B,IAAI,CAACzB,IAAI,EAAIA,IAAI,CAACiB,IAAI,CAACC,EAAE,GAAKD,IAAI,CAACC,EAAE,CAAC,CACjE,GAAIE,QAAQ,CAAE,CACZD,cAAc,CAACC,QAAQ,CAAEA,QAAQ,CAAClB,QAAQ,CAAG,CAAC,CAAC,CACjD,CAAC,IAAM,CACLP,YAAY,CAAC,CAAC,GAAGD,SAAS,CAAE,CAAEuB,IAAI,CAAEf,QAAQ,CAAE,CAAC,CAAED,KAAK,CAAEgB,IAAI,CAAChB,KAAM,CAAC,CAAC,CAAC,CACxE,CACF,CAAC,CAED,KAAM,CAAAyB,SAAS,CAAGA,CAAA,GAAM,CACtBvB,YAAY,CAACwB,UAAU,CAAC3C,QAAQ,CAAC,CACjC,KAAM,CAAEE,KAAK,CAAEC,UAAU,CAAEC,UAAW,CAAC,CAAGH,UAAU,CACpDU,YAAY,CAACT,KAAK,CAAC,CACnBU,aAAa,CAACT,UAAU,CAAC,CACzBU,aAAa,CAACT,UAAU,CAAC,CAC3B,CAAC,CAED,mBACEN,IAAA,CAACC,WAAW,CAAC6C,QAAQ,EACnBC,KAAK,CAAE,CACLC,IAAI,CAAE,CAAE5C,KAAK,CAAEQ,SAAS,CAAEP,UAAU,CAAEC,UAAW,CAAC,CAClDyB,cAAc,CACdM,cAAc,CACdK,SAAS,CACTE,SACF,CAAE,CAAAnC,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAEA,MAAO,MAAM,CAAAwC,OAAO,CAAGA,CAAA,GAAMrD,UAAU,CAACK,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}