{"ast":null,"code":"import _toConsumableArray from\"E:/foodiespaw/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"E:/foodiespaw/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"E:/foodiespaw/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";var CartContext=/*#__PURE__*/createContext(null);var CART_KEY='cart';var EMPTY_CART={items:[],totalPrice:0,totalCount:0};export default function CartProvider(_ref){var children=_ref.children;var initCart=getCartFromLocalStorage();var _useState=useState(initCart.items),_useState2=_slicedToArray(_useState,2),cartItems=_useState2[0],setCartItems=_useState2[1];var _useState3=useState(initCart.totalPrice),_useState4=_slicedToArray(_useState3,2),totalPrice=_useState4[0],setTotalPrice=_useState4[1];var _useState5=useState(initCart.totalCount),_useState6=_slicedToArray(_useState5,2),totalCount=_useState6[0],setTotalCount=_useState6[1];useEffect(function(){var totalPrice=sum(cartItems.map(function(item){return item.price;}));var totalCount=sum(cartItems.map(function(item){return item.quantity;}));setTotalPrice(totalPrice);setTotalCount(totalCount);localStorage.setItem(CART_KEY,JSON.stringify({items:cartItems,totalPrice:totalPrice,totalCount:totalCount}));},[cartItems]);function getCartFromLocalStorage(){var storedCart=localStorage.getItem(CART_KEY);return storedCart?JSON.parse(storedCart):EMPTY_CART;}var sum=function sum(items){return items.reduce(function(prevValue,curValue){return prevValue+curValue;},0);};var removeFromCart=function removeFromCart(foodId){var filteredCartItems=cartItems.filter(function(item){return item.food.id!==foodId;});setCartItems(filteredCartItems);};var changeQuantity=function changeQuantity(cartItem,newQauntity){var food=cartItem.food;var changedCartItem=_objectSpread(_objectSpread({},cartItem),{},{quantity:newQauntity,price:food.price*newQauntity});setCartItems(cartItems.map(function(item){return item.food.id===food.id?changedCartItem:item;}));};var addToCart=function addToCart(food){var cartItem=cartItems.find(function(item){return item.food.id===food.id;});if(cartItem){changeQuantity(cartItem,cartItem.quantity+1);}else{setCartItems([].concat(_toConsumableArray(cartItems),[{food:food,quantity:1,price:food.price}]));}};var clearCart=function clearCart(){localStorage.removeItem(CART_KEY);var items=EMPTY_CART.items,totalPrice=EMPTY_CART.totalPrice,totalCount=EMPTY_CART.totalCount;setCartItems(items);setTotalPrice(totalPrice);setTotalCount(totalCount);};return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart:{items:cartItems,totalPrice:totalPrice,totalCount:totalCount},removeFromCart:removeFromCart,changeQuantity:changeQuantity,addToCart:addToCart,clearCart:clearCart},children:children});}export var useCart=function useCart(){return useContext(CartContext);};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","jsx","_jsx","CartContext","CART_KEY","EMPTY_CART","items","totalPrice","totalCount","CartProvider","_ref","children","initCart","getCartFromLocalStorage","_useState","_useState2","_slicedToArray","cartItems","setCartItems","_useState3","_useState4","setTotalPrice","_useState5","_useState6","setTotalCount","sum","map","item","price","quantity","localStorage","setItem","JSON","stringify","storedCart","getItem","parse","reduce","prevValue","curValue","removeFromCart","foodId","filteredCartItems","filter","food","id","changeQuantity","cartItem","newQauntity","changedCartItem","_objectSpread","addToCart","find","concat","_toConsumableArray","clearCart","removeItem","Provider","value","cart","useCart"],"sources":["E:/foodiespaw/frontend/src/hooks/useCart.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\r\n\r\nconst CartContext = createContext(null);\r\nconst CART_KEY = 'cart';\r\nconst EMPTY_CART = {\r\n  items: [],\r\n  totalPrice: 0,\r\n  totalCount: 0,\r\n};\r\n\r\nexport default function CartProvider({ children }) {\r\n  const initCart = getCartFromLocalStorage();\r\n  const [cartItems, setCartItems] = useState(initCart.items);\r\n  const [totalPrice, setTotalPrice] = useState(initCart.totalPrice);\r\n  const [totalCount, setTotalCount] = useState(initCart.totalCount);\r\n\r\n  useEffect(() => {\r\n    const totalPrice = sum(cartItems.map(item => item.price));\r\n    const totalCount = sum(cartItems.map(item => item.quantity));\r\n    setTotalPrice(totalPrice);\r\n    setTotalCount(totalCount);\r\n\r\n    localStorage.setItem(\r\n      CART_KEY,\r\n      JSON.stringify({\r\n        items: cartItems,\r\n        totalPrice,\r\n        totalCount,\r\n      })\r\n    );\r\n  }, [cartItems]);\r\n\r\n  function getCartFromLocalStorage() {\r\n    const storedCart = localStorage.getItem(CART_KEY);\r\n    return storedCart ? JSON.parse(storedCart) : EMPTY_CART;\r\n  }\r\n\r\n  const sum = items => {\r\n    return items.reduce((prevValue, curValue) => prevValue + curValue, 0);\r\n  };\r\n\r\n  const removeFromCart = foodId => {\r\n    const filteredCartItems = cartItems.filter(item => item.food.id !== foodId);\r\n    setCartItems(filteredCartItems);\r\n  };\r\n\r\n  const changeQuantity = (cartItem, newQauntity) => {\r\n    const { food } = cartItem;\r\n\r\n    const changedCartItem = {\r\n      ...cartItem,\r\n      quantity: newQauntity,\r\n      price: food.price * newQauntity,\r\n    };\r\n\r\n    setCartItems(\r\n      cartItems.map(item => (item.food.id === food.id ? changedCartItem : item))\r\n    );\r\n  };\r\n\r\n  const addToCart = food => {\r\n    const cartItem = cartItems.find(item => item.food.id === food.id);\r\n    if (cartItem) {\r\n      changeQuantity(cartItem, cartItem.quantity + 1);\r\n    } else {\r\n      setCartItems([...cartItems, { food, quantity: 1, price: food.price }]);\r\n    }\r\n  };\r\n\r\n  const clearCart = () => {\r\n    localStorage.removeItem(CART_KEY);\r\n    const { items, totalPrice, totalCount } = EMPTY_CART;\r\n    setCartItems(items);\r\n    setTotalPrice(totalPrice);\r\n    setTotalCount(totalCount);\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart: { items: cartItems, totalPrice, totalCount },\r\n        removeFromCart,\r\n        changeQuantity,\r\n        addToCart,\r\n        clearCart,\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}